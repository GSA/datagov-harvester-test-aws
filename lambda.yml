version: 1
name: lambda
id: a1fa5f24-ed73-48e8-a99f-14906728b945
description: Customizable python lambda function
display_name: Lambda Function
image_url: 
documentation_url: https://aws.amazon.com/lambda/
support_url: https://github.com/GSA/datagov-brokerpak-harvester-aws
tags: [aws, lambda, function, harvester]

plans:
- name: base
  id: 4d7f0501-77d6-4d21-a37a-8b80a0ea9c0d
  description: Provision a python lambda function
  display_name: Provision a python lambda function
  bullets:
  - "REQUIRED prerequisite: An AWS Account into which Lambda Funcstion will be created."
  properties: {}
provision:
  plan_inputs: []
  user_inputs:
  - field_name: script
    required: true
    type: string
    details: "Python script in the form of a multiline string."
  - field_name: sqsInput
    required: true
    type: string
    details: "SQS Resource that will trigger lambda call."
  computed_inputs:
  - name: name
    type: string
    details: "The name of the lambda function."
    overwrite: true
    default: ${request.instance_id}
  - name: script
    default: "print('You need to supply a script!')"
    overwrite: true
    type: string
  - name: sqsInput
    overwrite: true
    type: string
  - name: region
    type: string
    details: "The AWS region in which to create all AWS resources"
    overwrite: true
    default: ${config("aws.default_region")}
  - name: zone
    type: string
    details: "The Route53 zone in which to create k8s instances"
    overwrite: true
    default: ${config("aws.zone")}
  outputs:
  - field_name: solr_leader_url
    details: "The Solr Leader url for the created instance"
    type: string
    required: true
  template_refs:
    variables: terraform/lambda/provision/variables.tf
    outputs: terraform/lambda/provision/outputs.tf
    lambda: terraform/lambda/provision/lambda.tf
    versions: terraform/lambda/provision/versions.tf
bind:
  plan_inputs: []
  user_inputs: []
  computed_inputs:
  - name: instance_name
    default: ${request.instance_id}
    overwrite: true
    type: string
  - name: solr_admin_pass
    default: ${instance.details["solr_admin_pass"]}
    overwrite: true
    type: string
  - name: solr_admin_user
    default: ${instance.details["solr_admin_user"]}
    overwrite: true
    type: string
  - name: solr_leader_url
    default: ${instance.details["solr_leader_url"]}
    overwrite: true
    type: string
  - name: solr_follower_url
    default: ${instance.details["solr_follower_url"]}
    overwrite: true
    type: string
  - name: solr_follower_individual_urls
    default: ${instance.details["solr_follower_individual_urls"]}
    overwrite: true
    type: string
  outputs:
  - field_name: domain
    required: false
    type: string
    details: The domain of the Solr Leader instance that was created
  - field_name: domain_replica
    required: false
    type: string
    details: The domain of the Solr Follower instances that were created
  - field_name: username
    required: false
    type: string
    details: The username of the Solr instances (leader + followers) that were created
  - field_name: password
    required: false
    type: string
    details: The password of the Solr instances (leader + followers) that were created
  - field_name: uri
    required: true
    type: string
    details: The URL to use for working with the Solr Leader instance
  - field_name: solr_leader_url
    details: "The Solr Leader url for the created instance"
    type: string
    required: true
  - field_name: solr_follower_url
    details: "The Solr Follower url for the created instance (routes to all follower instances randomly)"
    type: string
    required: true
  - field_name: solr_follower_individual_urls
    details: "The Solr Follower urls for each follower instance"
    type: string
    required: true
  - field_name: solr_admin_user
    details: "The admin username for access to the Solr instances (leader + followers)"
    type: string
    required: false
  - field_name: solr_admin_pass
    details: "The admin password for access to the Solr instances (leader + followers)"
    type: string
    required: false
  template_refs:
    main: terraform/ecs/bind/main.tf
    outputs: terraform/ecs/bind/outputs.tf
    variables: terraform/ecs/bind/variables.tf
    versions: terraform/ecs/bind/versions.tf

examples: []
plan_updateable: false
requiredenvvars: []
